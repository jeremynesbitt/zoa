C
C       THIS CODE HANDLES DETECTION OF CHANGED FIELD VALUES IN LENS EDITOR
C       AND ISSUED APPROPRIATE COMMANDS AND THEN RELOADS THE
C       SPREADSHEET GRID
C
C       ARE WE IN THE LENS EDITOR

        IF(MESSAGE%WIN.EQ.IDD_SURFACEEDITOR_RD) THEN
C       YES
C       SELECT THE DIALOG AT THE CURRENT DIALOG
        CALL WDIALOGSELECT(IDD_SURFACEEDITOR_RD)
C
         IF(MESSAGE%VALUE2.EQ.IDF_LENGRID1.OR.
     1      MESSAGE%VALUE1.EQ.IDF_LENGRID1) THEN
         CALL WGRIDPOS(MESSAGE%X,PREVCOL,PREVROW)
         CALL WGRIDPOS(MESSAGE%Y,CURCOL,CURROW)

        IF(MESSAGE%VALUE1.NE.IDF_LENGRID1.AND.
     1  MESSAGE%VALUE2.EQ.IDF_LENGRID1) THEN
C       MOVED ONTO THE GRID, NO UPDATE LENS COMMAND TO BE ISSUED
        INCLUDE 'READOTHER.INC'
                END IF
C       IF(MESSAGE%VALUE1.EQ.IDF_LENGRID1.AND.
C    1  MESSAGE%VALUE2.NE.IDF_LENGRID1) THEN
C       MOVED OFF THE GRID
C       WE NEED TO GET THE VALUE IN THE PREVIOUS GRID AND COMPARE IT
C       TO THE TEST VALUE. IF NOT THE SAME, ISSUE AN UPDATE LENS COMMAND
C       INCLUDE 'FIX_LENS.INC'
C               END IF
        IF(MESSAGE%VALUE1.EQ.IDF_LENGRID1.AND.
     1  MESSAGE%VALUE2.EQ.IDF_LENGRID1) THEN
C       MOVING ON THE GRID
C       WE NEED TO GET THE VALUE IN THE PREVIOUS GRID AND COMPARE IT
C       TO THE TEST VALUE. IF NOT THE SAME, ISSUE AN UPDATE LENS COMMAND
C       INCLUDE 'FIX_LENS.INC'
        INCLUDE 'READOTHER.INC'
                END IF
                END IF
                END IF
