C       ADVANCED RAY SETTINGS DIALOG HANDLER
C
        IF(MESSAGE%WIN.EQ.IDD_RAYSETTINGS) THEN
        CALL WDIALOGSELECT(IDD_RAYSETTINGS)
           SELECT CASE(MESSAGE%VALUE1)
            CASE (IDOK)
C       RADIO BUTTON STATUS
C       SURTOL
        CALL WDIALOGGETDOUBLE(IDF_SURTOL,SURTOL)
C       AIMTOL
        CALL WDIALOGGETDOUBLE(IDF_AIMTOL,AIMTOL)
C       CAIMTOL
        CALL WDIALOGGETDOUBLE(IDF_CAIMTOL,CAIMTOL)
C       MRAYS
        CALL WDIALOGGETINTEGER(IDF_MRAYS,MRAYS)
C       NRAITR
        CALL WDIALOGGETINTEGER(IDF_NRAITR,NRAITR)
C       NEWOBJ
        CALL WDIALOGGETINTEGER(IDF_NEWOBJ,NEWOBJ)
C       NEWOBJ
        CALL WDIALOGGETINTEGER(IDF_NEWREF,NEWREF)
C       NEWIMG
        CALL WDIALOGGETINTEGER(IDF_NEWIMG,NEWIMG)
C       RESET TO DEFAULTS CHECKBOX
        CALL WDIALOGGETCHECKBOX(IDF_DEFAULTS,ISET)
        IF(ISET.EQ.1) THEN
        AIMTOL=1.0D-8
        CAIMTOL=1.0D-3
        SURTOL=1.0D-8
        NRAITR=100
        MRAYS=200
        CALL WDIALOGPUTDOUBLE(IDF_SURTOL,SURTOL)
C       MRAYS
        CALL WDIALOGPUTINTEGER(IDF_MRAYS,MRAYS)
C       AIMTOL
        CALL WDIALOGPUTDOUBLE(IDF_AIMTOL,AIMTOL)
C       CAIMTOL
        CALL WDIALOGPUTDOUBLE(IDF_CAIMTOL,CAIMTOL)
C       NRAITR
        CALL WDIALOGPUTINTEGER(IDF_NRAITR,NRAITR)
C       RESET TO DEFAULTS CHECKBOX
        CALL WDIALOGGETCHECKBOX(IDF_DEFAULTS,ISET)
                END IF
        OUTLYNE='RAY SETTINGS HAVE BEEN ADJUSTED'
        CALL SHOWIT(0)
C
        CASE(IDCANCEL)
        CALL WDialogHide()
        CALL WDialogUnload()
        END SELECT
                                END IF
