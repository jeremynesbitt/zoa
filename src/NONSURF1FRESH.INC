        CALL WDIALOGSELECT(IDD_NONSURF1)
C
C       LOAD UP VALUES
C
C       CW,PWP,SWP
        CALL WDIALOGPUTINTEGER(IDF_CW,INT(SYSTEM(11)))
        CALL WDIALOGPUTINTEGER(IDF_PWP1,INT(SYSTEM(7)))
        CALL WDIALOGPUTINTEGER(IDF_PWP2,INT(SYSTEM(8)))
        CALL WDIALOGPUTINTEGER(IDF_SWP1,INT(SYSTEM(9)))
        CALL WDIALOGPUTINTEGER(IDF_SWP2,INT(SYSTEM(10)))
C
C       WAVELENGTHS
        CALL WDIALOGPUTDOUBLE(IDF_WV1,SYSTEM(1))
        CALL WDIALOGPUTDOUBLE(IDF_WV2,SYSTEM(2))
        CALL WDIALOGPUTDOUBLE(IDF_WV3,SYSTEM(3))
        CALL WDIALOGPUTDOUBLE(IDF_WV4,SYSTEM(4))
        CALL WDIALOGPUTDOUBLE(IDF_WV5,SYSTEM(5))
        CALL WDIALOGPUTDOUBLE(IDF_WV6,SYSTEM(71))
        CALL WDIALOGPUTDOUBLE(IDF_WV7,SYSTEM(72))
        CALL WDIALOGPUTDOUBLE(IDF_WV8,SYSTEM(73))
        CALL WDIALOGPUTDOUBLE(IDF_WV9,SYSTEM(74))
        CALL WDIALOGPUTDOUBLE(IDF_WV10,SYSTEM(75))
C       SPECTRAL WEIGHTS
        CALL WDIALOGPUTDOUBLE(IDF_SPTWT1,SYSTEM(31))
        CALL WDIALOGPUTDOUBLE(IDF_SPTWT2,SYSTEM(32))
        CALL WDIALOGPUTDOUBLE(IDF_SPTWT3,SYSTEM(33))
        CALL WDIALOGPUTDOUBLE(IDF_SPTWT4,SYSTEM(34))
        CALL WDIALOGPUTDOUBLE(IDF_SPTWT5,SYSTEM(35))
        CALL WDIALOGPUTDOUBLE(IDF_SPTWT6,SYSTEM(76))
        CALL WDIALOGPUTDOUBLE(IDF_SPTWT7,SYSTEM(77))
        CALL WDIALOGPUTDOUBLE(IDF_SPTWT8,SYSTEM(78))
        CALL WDIALOGPUTDOUBLE(IDF_SPTWT9,SYSTEM(79))
        CALL WDIALOGPUTDOUBLE(IDF_SPTWT10,SYSTEM(80))
C       LENS MODE
        IF(SYSTEM(30).EQ.1.0D0) CALL WDIALOGPUTRADIOBUTTON(IDF_MODE1)
        IF(SYSTEM(30).EQ.2.0D0) CALL WDIALOGPUTRADIOBUTTON(IDF_MODE3)
        IF(SYSTEM(30).EQ.3.0D0) CALL WDIALOGPUTRADIOBUTTON(IDF_MODE2)
        IF(SYSTEM(30).EQ.4.0D0) CALL WDIALOGPUTRADIOBUTTON(IDF_MODE4)
C       AIMING
        IF(SYSTEM(70).EQ.0.0D0) THEN
        IF(SYSTEM(63).EQ.0.0D0) THEN
        IF(SYSTEM(62).EQ.1.0D0) CALL WDIALOGPUTRADIOBUTTON(IDF_AIM1)
        IF(SYSTEM(62).EQ.0.0D0) CALL WDIALOGPUTRADIOBUTTON(IDF_AIM2)
                        END IF
        IF(SYSTEM(62).EQ.0.0D0) THEN
        IF(SYSTEM(63).EQ.1.0D0) CALL WDIALOGPUTRADIOBUTTON(IDF_AIM3)
                        END IF
                        ELSE
C       APLANATIC AIMING
        CALL WDIALOGPUTRADIOBUTTON(IDF_AIM4)
                        END IF
C       UNITS
        IF(SYSTEM(6).EQ.1.0D0) CALL WDIALOGPUTRADIOBUTTON(IDF_UNITS1)
        IF(SYSTEM(6).EQ.2.0D0) CALL WDIALOGPUTRADIOBUTTON(IDF_UNITS2)
        IF(SYSTEM(6).EQ.3.0D0) CALL WDIALOGPUTRADIOBUTTON(IDF_UNITS3)
        IF(SYSTEM(6).EQ.4.0D0) CALL WDIALOGPUTRADIOBUTTON(IDF_UNITS4)
C
C       LI
        CALL WDIALOGPUTSTRING(IDF_LI,LI)
C
C       LIC 1
        CALL WDIALOGPUTSTRING(IDF_LIC1,LIC(1))
C
C       LIC 2
        CALL WDIALOGPUTSTRING(IDF_LIC2,LIC(2))
C
C       LIC 3
        CALL WDIALOGPUTSTRING(IDF_LIC3,LIC(3))
C
C       LIC 4
        CALL WDIALOGPUTSTRING(IDF_LIC4,LIC(4))
C
C       INI
        CALL WDIALOGPUTSTRING(IDF_INI,INNI)
C
C       APERTURES
C
C       FIX SYSTEM(49)
        IF(SYSTEM(12).EQ.SYSTEM(13).AND.SYSTEM(49).EQ.1.0D0.OR.
     1  SYSTEM(12).EQ.SYSTEM(13).AND.SYSTEM(49).EQ.3.0D0)
     2  SYSTEM(49)=SYSTEM(49)-1.0D0
C
        IF(SYSTEM(49).NE.1.0D0.AND.SYSTEM(49).NE.3.0D0) THEN
        CALL WDIALOGPUTCHECKBOX(IDF_SAMEAPE,1)
                        ELSE
        CALL WDIALOGPUTCHECKBOX(IDF_SAMEAPE,0)
                        END IF
        IF(SYSTEM(64).EQ.1.0D0) THEN
C       NAO
        CALL WDIALOGPUTRADIOBUTTON(IDF_SAY2)
        CALL WDIALOGPUTDOUBLE(IDF_X,SYSTEM(66))
        CALL WDIALOGPUTDOUBLE(IDF_Y,SYSTEM(65))
                        END IF
        IF(SYSTEM(67).EQ.1.0D0) THEN
C       NAO
        CALL WDIALOGPUTRADIOBUTTON(IDF_SAY3)
        CALL WDIALOGPUTDOUBLE(IDF_X,SYSTEM(69))
        CALL WDIALOGPUTDOUBLE(IDF_Y,SYSTEM(67))
                        END IF
        IF(SYSTEM(83).EQ.1.0D0) SYSTEM(84)=1.0D0
        IF(SYSTEM(84).EQ.1.0D0) SYSTEM(83)=1.0D0
        IF(SYSTEM(83).EQ.1.0D0) THEN
C       SAY/SAX FLOAT
        CALL WDIALOGPUTRADIOBUTTON(IDF_SAY4)
        CALL WDIALOGPUTDOUBLE(IDF_X,(2.0D0*SYSTEM(13)))
        CALL WDIALOGPUTDOUBLE(IDF_Y,(2.0D0*SYSTEM(12)))
                        END IF
        IF(SYSTEM(83).EQ.0.0D0.AND.SYSTEM(84).EQ.0.0D0.AND.
     1  SYSTEM(67).EQ.0.0D0.AND.SYSTEM(64).EQ.0.0D0) THEN
C       EPD
        CALL WDIALOGPUTRADIOBUTTON(IDF_SAY1)
        CALL WDIALOGPUTDOUBLE(IDF_X,(2.0D0*SYSTEM(13)))
        CALL WDIALOGPUTDOUBLE(IDF_Y,(2.0D0*SYSTEM(12)))
                        END IF
C
C       FIELDS
        IF(SYSTEM(92).EQ.0.0D0.AND.SYSTEM(93).EQ.0.0D0.AND.
     1  SYSTEM(96).EQ.0.0D0.AND.SYSTEM(97).EQ.0.0D0) THEN
C       NOT PYIM,PXIM,RYIM OR RXIM
C
C       FIX SYSTEM(49)
        IF(SYSTEM(18).EQ.0.0D0.AND.SYSTEM(18).EQ.SYSTEM(19)) THEN
C       OBJ HT SAME MODE
C       WRITE(OUTLYNE,*) SYSTEM(14),SYSTEM(16)
C       CALL SHOWIT(1)
C       WRITE(OUTLYNE,*) SYSTEM(15),SYSTEM(17)
C       CALL SHOWIT(1)
        IF(SYSTEM(14).EQ.SYSTEM(16).AND.SYSTEM(15).EQ.SYSTEM(17).AND.
     1  SYSTEM(49).EQ.2.0D0.OR.
     1  SYSTEM(14).EQ.SYSTEM(16).AND.SYSTEM(15).EQ.SYSTEM(17).AND.
     1  SYSTEM(49).EQ.3.0D0) SYSTEM(49)=SYSTEM(49)-1.0D0
                        END IF
        IF(SYSTEM(18).EQ.1.0D0.AND.SYSTEM(18).EQ.SYSTEM(19)) THEN
C       OBJ ANG SAME MODE
C       WRITE(OUTLYNE,*) SYSTEM(21),SYSTEM(23)
C       CALL SHOWIT(1)
C       WRITE(OUTLYNE,*) SYSTEM(22),SYSTEM(24)
C       CALL SHOWIT(1)
        IF(SYSTEM(21).EQ.SYSTEM(23).AND.SYSTEM(22).EQ.SYSTEM(24).AND.
     1  SYSTEM(49).EQ.2.0D0.OR.
     1  SYSTEM(21).EQ.SYSTEM(23).AND.SYSTEM(22).EQ.SYSTEM(24).AND.
     1  SYSTEM(49).EQ.3.0D0) SYSTEM(49)=SYSTEM(49)-1.0D0
                        END IF
                        ELSE
        IF(SYSTEM(92).NE.0.0D0.AND.SYSTEM(93).NE.0.0D0.AND.
     1SYSTEM(92).EQ.SYSTEM(93).AND.SYSTEM(49).EQ.2.0D0.OR.
     1SYSTEM(92).NE.0.0D0.AND.SYSTEM(93).NE.0.0D0.AND.
     1SYSTEM(92).EQ.SYSTEM(93).AND.SYSTEM(49).EQ.3.0D0)
     4SYSTEM(49)=SYSTEM(49)-1.0D0
        IF(SYSTEM(96).NE.0.0D0.AND.SYSTEM(97).NE.0.0D0.AND.
     1SYSTEM(96).EQ.SYSTEM(97).AND.SYSTEM(49).EQ.2.0D0.OR.
     1SYSTEM(96).NE.0.0D0.AND.SYSTEM(97).NE.0.0D0.AND.
     1SYSTEM(96).EQ.SYSTEM(97).AND.SYSTEM(49).EQ.3.0D0)
     4SYSTEM(49)=SYSTEM(49)-1.0D0
                        END IF
C
        IF(SYSTEM(49).NE.2.0D0.AND.SYSTEM(49).NE.3.0D0) THEN
        CALL WDIALOGPUTCHECKBOX(IDF_SAMEFIELD,1)
                        ELSE
        CALL WDIALOGPUTCHECKBOX(IDF_SAMEFIELD,0)
                        END IF
        IF(SYSTEM(60).EQ.1.0D0.OR.SYSTEM(61).EQ.1.0D0) THEN
        SYSTEM(60)=1.0D0
        SYSTEM(61)=1.0D0
        END IF
C       SCY/SCX OR SCY FANG/SCX FANG EXPLICITLY
        IF(SYSTEM(18).EQ.0.0D0) THEN
C       SCY/SCX
        CALL WDIALOGPUTRADIOBUTTON(IDF_F1)
        CALL WDIALOGPUTDOUBLE(IDF_XREF,SYSTEM(16))
        CALL WDIALOGPUTDOUBLE(IDF_YREF,SYSTEM(14))
        CALL WDIALOGFIELDSTATE(IDF_CX,1)
        CALL WDIALOGFIELDSTATE(IDF_CY,1)
        CALL WDIALOGPUTDOUBLE(IDF_CX,SYSTEM(17))
        CALL WDIALOGPUTDOUBLE(IDF_CY,SYSTEM(15))
                        ELSE
C       SCY FANG/SCX FANG
        CALL WDIALOGPUTRADIOBUTTON(IDF_F2)
        CALL WDIALOGPUTDOUBLE(IDF_XREF,SYSTEM(23))
        CALL WDIALOGPUTDOUBLE(IDF_YREF,SYSTEM(21))
        CALL WDIALOGFIELDSTATE(IDF_CX,1)
        CALL WDIALOGFIELDSTATE(IDF_CY,1)
        CALL WDIALOGPUTDOUBLE(IDF_CX,SYSTEM(24))
        CALL WDIALOGPUTDOUBLE(IDF_CY,SYSTEM(22))
                        END IF
        IF(SYSTEM(94).NE.0.0D0.OR.SYSTEM(95).NE.0.0D0) THEN
        SYSTEM(94)=SYSTEM(95)
C       PYIM AND PXIM
        IF(SYSTEM(94).EQ.-1.0D0) THEN
C       PXIM/PYIM
        CALL WDIALOGPUTRADIOBUTTON(IDF_F3)
        CALL WDIALOGPUTDOUBLE(IDF_XREF,SYSTEM(92))
        CALL WDIALOGPUTDOUBLE(IDF_YREF,SYSTEM(93))
        CALL WDIALOGCLEARFIELD(IDF_CX)
        CALL WDIALOGCLEARFIELD(IDF_CY)
        CALL WDIALOGFIELDSTATE(IDF_CX,2)
        CALL WDIALOGFIELDSTATE(IDF_CY,2)
                        ELSE
C       PXIM FANG, PXIM FANG
        CALL WDIALOGPUTRADIOBUTTON(IDF_F4)
        CALL WDIALOGPUTDOUBLE(IDF_XREF,SYSTEM(92))
        CALL WDIALOGPUTDOUBLE(IDF_YREF,SYSTEM(93))
        CALL WDIALOGCLEARFIELD(IDF_CX)
        CALL WDIALOGCLEARFIELD(IDF_CY)
        CALL WDIALOGFIELDSTATE(IDF_CX,2)
        CALL WDIALOGFIELDSTATE(IDF_CY,2)
                        END IF
                        END IF
        IF(SYSTEM(98).NE.0.0D0.OR.SYSTEM(99).NE.0.0D0) THEN
        SYSTEM(98)=SYSTEM(99)
C       RYIM AND RXIM
        IF(SYSTEM(98).EQ.-1.0D0) THEN
C       RXIM/RYIM
        CALL WDIALOGPUTRADIOBUTTON(IDF_F5)
        CALL WDIALOGPUTDOUBLE(IDF_XREF,SYSTEM(96))
        CALL WDIALOGPUTDOUBLE(IDF_YREF,SYSTEM(97))
        CALL WDIALOGCLEARFIELD(IDF_CX)
        CALL WDIALOGCLEARFIELD(IDF_CY)
        CALL WDIALOGFIELDSTATE(IDF_CX,2)
        CALL WDIALOGFIELDSTATE(IDF_CY,2)
                        ELSE
C       RXIM FANG, RXIM FANG
        CALL WDIALOGPUTRADIOBUTTON(IDF_F6)
        CALL WDIALOGPUTDOUBLE(IDF_XREF,SYSTEM(96))
        CALL WDIALOGPUTDOUBLE(IDF_YREF,SYSTEM(97))
        CALL WDIALOGCLEARFIELD(IDF_CX)
        CALL WDIALOGCLEARFIELD(IDF_CY)
        CALL WDIALOGFIELDSTATE(IDF_CX,2)
        CALL WDIALOGFIELDSTATE(IDF_CY,2)
                        END IF
                        END IF
        CALL WDialogShow(-1,-1,0,Modeless)
