        CALL WDIALOGSELECT(IDD_NONSURF1)
C
C       FIELDS
        IF(SYSTEM(92).EQ.0.0D0.AND.SYSTEM(93).EQ.0.0D0.AND.
     1  SYSTEM(96).EQ.0.0D0.AND.SYSTEM(97).EQ.0.0D0) THEN
C       NOT PYIM,PXIM,RYIM OR RXIM
C
C       FIX SYSTEM(49)
        IF(SYSTEM(18).EQ.0.0D0.AND.SYSTEM(18).EQ.SYSTEM(19)) THEN
C       OBJ HT SAME MODE
C       WRITE(OUTLYNE,*) SYSTEM(14),SYSTEM(16)
C       CALL SHOWIT(1)
C       WRITE(OUTLYNE,*) SYSTEM(15),SYSTEM(17)
C       CALL SHOWIT(1)
        IF(SYSTEM(14).EQ.SYSTEM(16).AND.SYSTEM(15).EQ.SYSTEM(17).AND.
     1  SYSTEM(49).EQ.2.0D0.OR.
     1  SYSTEM(14).EQ.SYSTEM(16).AND.SYSTEM(15).EQ.SYSTEM(17).AND.
     1  SYSTEM(49).EQ.3.0D0) SYSTEM(49)=SYSTEM(49)-1.0D0
                        END IF
        IF(SYSTEM(18).EQ.1.0D0.AND.SYSTEM(18).EQ.SYSTEM(19)) THEN
C       OBJ ANG SAME MODE
C       WRITE(OUTLYNE,*) SYSTEM(21),SYSTEM(23)
C       CALL SHOWIT(1)
C       WRITE(OUTLYNE,*) SYSTEM(22),SYSTEM(24)
C       CALL SHOWIT(1)
        IF(SYSTEM(21).EQ.SYSTEM(23).AND.SYSTEM(22).EQ.SYSTEM(24).AND.
     1  SYSTEM(49).EQ.2.0D0.OR.
     1  SYSTEM(21).EQ.SYSTEM(23).AND.SYSTEM(22).EQ.SYSTEM(24).AND.
     1  SYSTEM(49).EQ.3.0D0) SYSTEM(49)=SYSTEM(49)-1.0D0
                        END IF
                        ELSE
        IF(SYSTEM(92).NE.0.0D0.AND.SYSTEM(93).NE.0.0D0.AND.
     1SYSTEM(92).EQ.SYSTEM(93).AND.SYSTEM(49).EQ.2.0D0.OR.
     1SYSTEM(92).NE.0.0D0.AND.SYSTEM(93).NE.0.0D0.AND.
     1SYSTEM(92).EQ.SYSTEM(93).AND.SYSTEM(49).EQ.3.0D0)
     4SYSTEM(49)=SYSTEM(49)-1.0D0
        IF(SYSTEM(96).NE.0.0D0.AND.SYSTEM(97).NE.0.0D0.AND.
     1SYSTEM(96).EQ.SYSTEM(97).AND.SYSTEM(49).EQ.2.0D0.OR.
     1SYSTEM(96).NE.0.0D0.AND.SYSTEM(97).NE.0.0D0.AND.
     1SYSTEM(96).EQ.SYSTEM(97).AND.SYSTEM(49).EQ.3.0D0)
     4SYSTEM(49)=SYSTEM(49)-1.0D0
                        END IF
C
        IF(SYSTEM(49).NE.2.0D0.AND.SYSTEM(49).NE.3.0D0) THEN
        CALL WDIALOGPUTCHECKBOX(IDF_SAMEFIELD,1)
                        ELSE
        CALL WDIALOGPUTCHECKBOX(IDF_SAMEFIELD,0)
                        END IF
        IF(SYSTEM(60).EQ.1.0D0.OR.SYSTEM(61).EQ.1.0D0) THEN
        SYSTEM(60)=1.0D0
        SYSTEM(61)=1.0D0
                END IF
C       SCY/SCX OR SCY FANG/SCX FANG EXPLICITLY
        IF(SYSTEM(18).EQ.0.0D0) THEN
C       SCY/SCX
        CALL WDIALOGPUTRADIOBUTTON(IDF_F1)
        CALL WDIALOGPUTDOUBLE(IDF_XREF,SYSTEM(16))
        CALL WDIALOGPUTDOUBLE(IDF_YREF,SYSTEM(14))
        CALL WDIALOGFIELDSTATE(IDF_CX,1)
        CALL WDIALOGFIELDSTATE(IDF_CY,1)
        CALL WDIALOGPUTDOUBLE(IDF_CX,SYSTEM(17))
        CALL WDIALOGPUTDOUBLE(IDF_CY,SYSTEM(15))
                        ELSE
C       SCY FANG/SCX FANG
        CALL WDIALOGPUTRADIOBUTTON(IDF_F2)
        CALL WDIALOGPUTDOUBLE(IDF_XREF,SYSTEM(23))
        CALL WDIALOGPUTDOUBLE(IDF_YREF,SYSTEM(21))
        CALL WDIALOGFIELDSTATE(IDF_CX,1)
        CALL WDIALOGFIELDSTATE(IDF_CY,1)
        CALL WDIALOGPUTDOUBLE(IDF_CX,SYSTEM(24))
        CALL WDIALOGPUTDOUBLE(IDF_CY,SYSTEM(22))
                        END IF
        IF(SYSTEM(94).NE.0.0D0.OR.SYSTEM(95).NE.0.0D0) THEN
        SYSTEM(94)=SYSTEM(95)
C       PYIM AND PXIM
        IF(SYSTEM(94).EQ.-1.0D0) THEN
C       PXIM/PYIM
        CALL WDIALOGPUTRADIOBUTTON(IDF_F3)
        CALL WDIALOGPUTDOUBLE(IDF_XREF,SYSTEM(92))
        CALL WDIALOGPUTDOUBLE(IDF_YREF,SYSTEM(93))
        CALL WDIALOGCLEARFIELD(IDF_CX)
        CALL WDIALOGCLEARFIELD(IDF_CY)
        CALL WDIALOGFIELDSTATE(IDF_CX,2)
        CALL WDIALOGFIELDSTATE(IDF_CY,2)
                        ELSE
C       PXIM FANG, PXIM FANG
        CALL WDIALOGPUTRADIOBUTTON(IDF_F4)
        CALL WDIALOGPUTDOUBLE(IDF_XREF,SYSTEM(92))
        CALL WDIALOGPUTDOUBLE(IDF_YREF,SYSTEM(93))
        CALL WDIALOGCLEARFIELD(IDF_CX)
        CALL WDIALOGCLEARFIELD(IDF_CY)
        CALL WDIALOGFIELDSTATE(IDF_CX,2)
        CALL WDIALOGFIELDSTATE(IDF_CY,2)
                        END IF
                        END IF
        IF(SYSTEM(98).NE.0.0D0.OR.SYSTEM(99).NE.0.0D0) THEN
        SYSTEM(98)=SYSTEM(99)
C       RYIM AND RXIM
        IF(SYSTEM(98).EQ.-1.0D0) THEN
C       RXIM/RYIM
        CALL WDIALOGPUTRADIOBUTTON(IDF_F5)
        CALL WDIALOGPUTDOUBLE(IDF_XREF,SYSTEM(96))
        CALL WDIALOGPUTDOUBLE(IDF_YREF,SYSTEM(97))
        CALL WDIALOGCLEARFIELD(IDF_CX)
        CALL WDIALOGCLEARFIELD(IDF_CY)
        CALL WDIALOGFIELDSTATE(IDF_CX,2)
        CALL WDIALOGFIELDSTATE(IDF_CY,2)
                        ELSE
C       RXIM FANG, RXIM FANG
        CALL WDIALOGPUTRADIOBUTTON(IDF_F6)
        CALL WDIALOGPUTDOUBLE(IDF_XREF,SYSTEM(96))
        CALL WDIALOGPUTDOUBLE(IDF_YREF,SYSTEM(97))
        CALL WDIALOGCLEARFIELD(IDF_CX)
        CALL WDIALOGCLEARFIELD(IDF_CY)
        CALL WDIALOGFIELDSTATE(IDF_CX,2)
        CALL WDIALOGFIELDSTATE(IDF_CY,2)
                        END IF
                        END IF
        CALL WDialogShow(-1,-1,0,Modeless)
