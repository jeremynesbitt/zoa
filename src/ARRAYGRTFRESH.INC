C       ARRAY AND DIFFRACTION GRATINGS
C
        CALL WDialogSelect(IDD_GRTARRAY)
        J=EDIT_SURFACE
        CALL ITOAA(J,AJ)
        Call WDialogPutInteger(IDF_SURFNUM,J)
C
C       GRATING
C
C       NO GRATING
        IF(ALENS(96,EDIT_SURFACE).EQ.0.0D0) THEN
        CALL WDIALOGPUTRADIOBUTTON(IDF_GRT1)
        CALL WDIALOGPUTDOUBLE(IDF_GRO,0.0D0)
        CALL WDIALOGPUTDOUBLE(IDF_GRS,0.0D0)
        CALL WDIALOGPUTDOUBLE(IDF_GRX,1.0D0)
        CALL WDIALOGPUTDOUBLE(IDF_GRY,0.0D0)
        CALL WDIALOGPUTDOUBLE(IDF_GRZ,0.0D0)
                        END IF
C       GRATING
        IF(ALENS(96,EDIT_SURFACE).NE.0.0D0) THEN
        CALL WDIALOGPUTRADIOBUTTON(IDF_GRT2)
        CALL WDIALOGPUTDOUBLE(IDF_GRO,ALENS(97,J))
        CALL WDIALOGPUTDOUBLE(IDF_GRS,ALENS(98,J))
        CALL WDIALOGPUTDOUBLE(IDF_GRX,ALENS(99,J))
        CALL WDIALOGPUTDOUBLE(IDF_GRY,ALENS(100,J))
        CALL WDIALOGPUTDOUBLE(IDF_GRZ,ALENS(101,J))
                        END IF
C       ARRAY LENS
C
C       NO ARRAY
        IF(ALENS(133,EDIT_SURFACE).EQ.0.0D0) THEN
        CALL WDIALOGPUTRADIOBUTTON(IDF_ARRAY1)
        CALL WDIALOGPUTRADIOBUTTON(IDF_EVENODD1)
        CALL WDIALOGPUTDOUBLE(IDF_DX,0.0D0)
        CALL WDIALOGPUTDOUBLE(IDF_DY,0.0D0)
                        END IF
C       ARRAY
        IF(ALENS(133,EDIT_SURFACE).NE.0.0D0) THEN
        CALL WDIALOGPUTRADIOBUTTON(IDF_ARRAY2)
        IF(ALENS(133,J).LT.0.0D0)
     1  CALL WDIALOGPUTRADIOBUTTON(IDF_EVENODD1)
        IF(ALENS(133,J).GT.0.0D0)
     1  CALL WDIALOGPUTRADIOBUTTON(IDF_EVENODD2)
        CALL WDIALOGPUTDOUBLE(IDF_DX,ALENS(131,J))
        CALL WDIALOGPUTDOUBLE(IDF_DY,ALENS(132,J))
                        END IF
        CALL WDialogShow(-1,-1,0,Modeless)
