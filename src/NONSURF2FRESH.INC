        CALL WDIALOGSELECT(IDD_NONSURF2)
C
C       LOAD UP VALUES
C
C       GAUSSIAN
        CALL WDIALOGPUTDOUBLE(IDF_WRX,SYSTEM(85))
        CALL WDIALOGPUTDOUBLE(IDF_WRY,SYSTEM(86))
        CALL WDIALOGPUTDOUBLE(IDF_BDX,SYSTEM(87))
        CALL WDIALOGPUTDOUBLE(IDF_BDY,SYSTEM(88))
C
C       AUTOFUNCTION
        CALL WDIALOGPUTINTEGER(IDF_FUNCNUM,INT(SYSTEM(91)))
        CALL WDIALOGPUTCHECKBOX(IDF_AUTOFUNC,0)
        IF(SYSTEM(91).GT.0.0D0) CALL WDIALOGPUTCHECKBOX(IDF_AUTOFUNC,1)
C
C       IDEAL AND REAL
        CALL WDIALOGFIELDSTATE(IDF_IDEALEFL,0)
        CALL WDIALOGCLEARFIELD(IDF_IDEALEFL)
        CALL WDIALOGPUTCHECKBOX(IDF_IDEAL,0)
        CALL WDIALOGPUTCHECKBOX(IDF_PERFECT,0)
        IF(ALENS(121,INT(SYSTEM(20))-1).NE.0.0D0) THEN
C       IDEAL
        CALL WDIALOGFIELDSTATE(IDF_IDEALEFL,1)
        CALL WDIALOGPUTDOUBLE(IDF_IDEALEFL,ALENS(121,NEWIMG-1))
        CALL WDIALOGPUTCHECKBOX(IDF_IDEAL,1)
        CALL WDIALOGPUTCHECKBOX(IDF_PERFECT,0)
                        END IF
        IF(GLANAM(INT(SYSTEM(20))-1,2).EQ.'PERFECT      ') THEN
C       PERFECT
        CALL WDIALOGFIELDSTATE(IDF_IDEALEFL,0)
        CALL WDIALOGCLEARFIELD(IDF_IDEALEFL)
        CALL WDIALOGPUTCHECKBOX(IDF_PERFECT,1)
        CALL WDIALOGPUTCHECKBOX(IDF_IDEAL,0)
                        END IF
C
C       MAXFLDS
        CALL WDIALOGPUTINTEGER(IDF_MAXFLDS,CFLDCNT)
                        DO I=1,10
        CALL WDIALOGCLEARFIELD(IDF_X1)
        CALL WDIALOGCLEARFIELD(IDF_X2)
        CALL WDIALOGCLEARFIELD(IDF_X3)
        CALL WDIALOGCLEARFIELD(IDF_X4)
        CALL WDIALOGCLEARFIELD(IDF_X5)
        CALL WDIALOGCLEARFIELD(IDF_X6)
        CALL WDIALOGCLEARFIELD(IDF_X7)
        CALL WDIALOGCLEARFIELD(IDF_X8)
        CALL WDIALOGCLEARFIELD(IDF_X9)
        CALL WDIALOGCLEARFIELD(IDF_X10)
        CALL WDIALOGCLEARFIELD(IDF_Y1)
        CALL WDIALOGCLEARFIELD(IDF_Y2)
        CALL WDIALOGCLEARFIELD(IDF_Y3)
        CALL WDIALOGCLEARFIELD(IDF_Y4)
        CALL WDIALOGCLEARFIELD(IDF_Y5)
        CALL WDIALOGCLEARFIELD(IDF_Y6)
        CALL WDIALOGCLEARFIELD(IDF_Y7)
        CALL WDIALOGCLEARFIELD(IDF_Y8)
        CALL WDIALOGCLEARFIELD(IDF_Y9)
        CALL WDIALOGCLEARFIELD(IDF_Y10)
        CALL WDIALOGFIELDSTATE(IDF_X1,2)
        CALL WDIALOGFIELDSTATE(IDF_X2,2)
        CALL WDIALOGFIELDSTATE(IDF_X3,2)
        CALL WDIALOGFIELDSTATE(IDF_X4,2)
        CALL WDIALOGFIELDSTATE(IDF_X5,2)
        CALL WDIALOGFIELDSTATE(IDF_X6,2)
        CALL WDIALOGFIELDSTATE(IDF_X7,2)
        CALL WDIALOGFIELDSTATE(IDF_X8,2)
        CALL WDIALOGFIELDSTATE(IDF_X9,2)
        CALL WDIALOGFIELDSTATE(IDF_X10,2)
        CALL WDIALOGFIELDSTATE(IDF_Y1,2)
        CALL WDIALOGFIELDSTATE(IDF_Y2,2)
        CALL WDIALOGFIELDSTATE(IDF_Y3,2)
        CALL WDIALOGFIELDSTATE(IDF_Y4,2)
        CALL WDIALOGFIELDSTATE(IDF_Y5,2)
        CALL WDIALOGFIELDSTATE(IDF_Y6,2)
        CALL WDIALOGFIELDSTATE(IDF_Y7,2)
        CALL WDIALOGFIELDSTATE(IDF_Y8,2)
        CALL WDIALOGFIELDSTATE(IDF_Y9,2)
        CALL WDIALOGFIELDSTATE(IDF_Y10,2)
                        END DO
                        IF(CFLDCNT.GE.1) THEN
        CALL WDIALOGPUTDOUBLE(IDF_X1,CFLDS(1,1))
        CALL WDIALOGPUTDOUBLE(IDF_Y1,CFLDS(2,1))
        CALL WDIALOGFIELDSTATE(IDF_X1,1)
        CALL WDIALOGFIELDSTATE(IDF_Y1,1)
                        END IF
                        IF(CFLDCNT.GE.2) THEN
        CALL WDIALOGPUTDOUBLE(IDF_X2,CFLDS(1,2))
        CALL WDIALOGPUTDOUBLE(IDF_Y2,CFLDS(2,2))
        CALL WDIALOGFIELDSTATE(IDF_X2,1)
        CALL WDIALOGFIELDSTATE(IDF_Y2,1)
                        END IF
                        IF(CFLDCNT.GE.3) THEN
        CALL WDIALOGPUTDOUBLE(IDF_X3,CFLDS(1,3))
        CALL WDIALOGPUTDOUBLE(IDF_Y3,CFLDS(2,3))
        CALL WDIALOGFIELDSTATE(IDF_X3,1)
        CALL WDIALOGFIELDSTATE(IDF_Y3,1)
                        END IF
                        IF(CFLDCNT.GE.4) THEN
        CALL WDIALOGPUTDOUBLE(IDF_X4,CFLDS(1,4))
        CALL WDIALOGPUTDOUBLE(IDF_Y4,CFLDS(2,4))
        CALL WDIALOGFIELDSTATE(IDF_X4,1)
        CALL WDIALOGFIELDSTATE(IDF_Y4,1)
                        END IF
                        IF(CFLDCNT.GE.5) THEN
        CALL WDIALOGPUTDOUBLE(IDF_X5,CFLDS(1,5))
        CALL WDIALOGPUTDOUBLE(IDF_Y5,CFLDS(2,5))
        CALL WDIALOGFIELDSTATE(IDF_X5,1)
        CALL WDIALOGFIELDSTATE(IDF_Y5,1)
                        END IF
                        IF(CFLDCNT.GE.6) THEN
        CALL WDIALOGPUTDOUBLE(IDF_X6,CFLDS(1,6))
        CALL WDIALOGPUTDOUBLE(IDF_Y6,CFLDS(2,6))
        CALL WDIALOGFIELDSTATE(IDF_X6,1)
        CALL WDIALOGFIELDSTATE(IDF_Y6,1)
                        END IF
                        IF(CFLDCNT.GE.7) THEN
        CALL WDIALOGPUTDOUBLE(IDF_X7,CFLDS(1,7))
        CALL WDIALOGPUTDOUBLE(IDF_Y7,CFLDS(2,7))
        CALL WDIALOGFIELDSTATE(IDF_X7,1)
        CALL WDIALOGFIELDSTATE(IDF_Y7,1)
                        END IF
                        IF(CFLDCNT.GE.8) THEN
        CALL WDIALOGPUTDOUBLE(IDF_X8,CFLDS(1,8))
        CALL WDIALOGPUTDOUBLE(IDF_Y8,CFLDS(2,8))
        CALL WDIALOGFIELDSTATE(IDF_X8,1)
        CALL WDIALOGFIELDSTATE(IDF_Y8,1)
                        END IF
                        IF(CFLDCNT.GE.9) THEN
        CALL WDIALOGPUTDOUBLE(IDF_X9,CFLDS(1,9))
        CALL WDIALOGPUTDOUBLE(IDF_Y9,CFLDS(2,9))
        CALL WDIALOGFIELDSTATE(IDF_X9,1)
        CALL WDIALOGFIELDSTATE(IDF_Y9,1)
                        END IF
                        IF(CFLDCNT.GE.10) THEN
        CALL WDIALOGPUTDOUBLE(IDF_X10,CFLDS(1,10))
        CALL WDIALOGPUTDOUBLE(IDF_Y10,CFLDS(2,10))
        CALL WDIALOGFIELDSTATE(IDF_X10,1)
        CALL WDIALOGFIELDSTATE(IDF_Y10,1)
                        END IF
C
C
        CALL WDialogShow(-1,-1,0,Modeless)
